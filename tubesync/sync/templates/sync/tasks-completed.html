{% extends 'base.html' %}{% load filters %}

{% block headtitle %}Tasks - Completed{% endblock %}

{% block content %}
<h1 class="truncate">Completed tasks</h1>

{% include 'infobox.html' with message=message %}

<div class="divide-y divide-border rounded-lg border border-border overflow-hidden mb-6">
  {% for task in tasks %}
    <div class="p-4">
      {% if task.has_error %}
        <i class="fas fa-exclamation-triangle text-destructive"></i> <strong>{% if task.verbose_name %}{{ task.verbose_name }}{% else %}{{ task.name }}{% endif %}</strong><br>
        <span class="text-sm text-muted-foreground">Queue: &quot;{{ task.queue }}&quot;</span><br>
        <span class="text-sm text-destructive">Error: &quot;{{ task.error_message }}&quot;</span><br>
      {% else %}
        <i class="fas fa-check text-green-600"></i> <strong>{% if task.verbose_name %}{{ task.verbose_name }}{% else %}{{ task.name }}{% endif %}</strong><br>
        <span class="text-sm text-muted-foreground">Queue: &quot;{{ task.queue }}&quot;</span><br>
      {% endif %}
      <span class="text-sm text-muted-foreground">Task locked for: {{ task.end_at|sub:task.start_at|timedelta }}</span><br>
      <span class="text-sm text-muted-foreground"><i class="far fa-clock"></i> Task locked at <strong class="text-foreground">{{ task.start_at|date:'Y-m-d H:i:s' }}</strong></span><br>
      <span class="text-sm text-muted-foreground"><i class="fas fa-hourglass-end"></i> Task ended at <strong class="text-foreground">{{ task.end_at|date:'Y-m-d H:i:s' }}</strong></span>
    </div>
  {% empty %}
    <div class="p-4 text-muted-foreground"><i class="fas fa-info-circle"></i> There have been no completed tasks{% if source %} that match the specified source filter{% endif %}.</div>
  {% endfor %}
</div>

{% include 'pagination.html' with filter=source.pk %}
{% endblock %}
